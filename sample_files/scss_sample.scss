// =============================================================================
// Comprehensive SCSS Sample - Syntax Highlighting Demonstration
//
// This file demonstrates all major SCSS language features
// for syntax highlighting purposes.
// =============================================================================

// =============================================================================
// Variables
// =============================================================================

// Color variables
$color-primary: #3498db;
$color-secondary: #2ecc71;
$color-accent: #e74c3c;
$color-text: #333333;
$color-background: #ffffff;

// Numeric variables
$font-size-base: 16px;
$spacing-unit: 8px;
$border-radius: 4px;
$z-index-modal: 1000;

// String variables
$font-family-sans: 'Inter', -apple-system, sans-serif;
$font-family-mono: 'Fira Code', monospace;
$image-path: '../images/';

// Boolean variables
$enable-shadows: true;
$enable-rounded: true;
$enable-transitions: true;

// Null variable
$optional-feature: null;

// List variables
$breakpoints: (320px, 768px, 1024px, 1200px);
$spacing-sizes: 0, 0.25rem, 0.5rem, 1rem, 1.5rem, 2rem, 3rem;
$font-weights: 300, 400, 500, 600, 700;

// Map variables
$colors: (
  'primary': $color-primary,
  'secondary': $color-secondary,
  'accent': $color-accent,
  'success': #27ae60,
  'warning': #f39c12,
  'error': #c0392b,
);

$breakpoint-map: (
  'xs': 0,
  'sm': 576px,
  'md': 768px,
  'lg': 992px,
  'xl': 1200px,
  'xxl': 1400px,
);

$theme: (
  'light': (
    'background': #ffffff,
    'text': #333333,
    'border': #e0e0e0,
  ),
  'dark': (
    'background': #1a1a1a,
    'text': #f5f5f5,
    'border': #444444,
  ),
);

// =============================================================================
// Default Values and Configuration
// =============================================================================

$config: () !default;
$prefix: 'app' !default;
$important: false !default;

// Variable shadowing
$global-var: 'global';

.local-scope {
  $global-var: 'local' !global;
  $local-var: 'only here';
}

// =============================================================================
// Interpolation
// =============================================================================

$property: 'margin';
$side: 'top';
$selector: 'button';
$pseudo: 'hover';

.#{$selector} {
  #{$property}-#{$side}: 10px;

  &:#{$pseudo} {
    opacity: 0.8;
  }
}

// Class name interpolation
@for $i from 1 through 12 {
  .col-#{$i} {
    width: percentage($i / 12);
  }
}

// =============================================================================
// Nesting
// =============================================================================

.card {
  padding: $spacing-unit * 2;
  background: white;
  border-radius: $border-radius;

  // Nested rules
  .card-header {
    padding: $spacing-unit;
    border-bottom: 1px solid #eee;

    // Deep nesting
    .title {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .subtitle {
      font-size: 0.875rem;
      color: #666;
    }
  }

  .card-body {
    padding: $spacing-unit * 2;
  }

  .card-footer {
    padding: $spacing-unit;
    border-top: 1px solid #eee;
  }

  // Parent selector (&)
  &:hover {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  &:focus-within {
    outline: 2px solid $color-primary;
  }

  &.is-active {
    border-color: $color-primary;
  }

  &--large {
    padding: $spacing-unit * 4;
  }

  &--small {
    padding: $spacing-unit;
  }

  // Nested media query
  @media (max-width: 768px) {
    padding: $spacing-unit;
  }
}

// Selector lists with nesting
.alert,
.notification {
  padding: $spacing-unit * 2;

  &.is-dismissible {
    padding-right: $spacing-unit * 4;
  }
}

// =============================================================================
// Operators
// =============================================================================

.operators {
  // Arithmetic
  width: 100% / 3;
  height: 100px + 50px;
  margin: 20px - 5px;
  padding: $spacing-unit * 2;
  font-size: $font-size-base + 2px;

  // Modulo
  $remainder: 17 % 5;

  // Comparison
  $is-equal: 1 == 1;
  $is-not-equal: 1 != 2;
  $is-greater: 10 > 5;
  $is-less: 5 < 10;
  $is-greater-equal: 10 >= 10;
  $is-less-equal: 5 <= 10;

  // Logical
  $and-result: true and false;
  $or-result: true or false;
  $not-result: not true;

  // String concatenation
  $combined: 'hello' + ' ' + 'world';
  $unquoted: hello + world;
}

// =============================================================================
// Built-in Functions
// =============================================================================

.functions {
  // Color functions
  color: lighten($color-primary, 20%);
  color: darken($color-primary, 20%);
  color: saturate($color-primary, 20%);
  color: desaturate($color-primary, 20%);
  color: adjust-hue($color-primary, 180deg);
  color: complement($color-primary);
  color: invert($color-primary);
  color: grayscale($color-primary);
  color: mix($color-primary, $color-secondary, 50%);
  color: rgba($color-primary, 0.5);
  color: opacify(rgba($color-primary, 0.5), 0.3);
  color: transparentize($color-primary, 0.3);
  color: adjust-color($color-primary, $lightness: 10%, $saturation: -5%);
  color: scale-color($color-primary, $lightness: 20%);
  color: change-color($color-primary, $hue: 180);

  // Color component functions
  $hue: hue($color-primary);
  $saturation: saturation($color-primary);
  $lightness: lightness($color-primary);
  $red: red($color-primary);
  $green: green($color-primary);
  $blue: blue($color-primary);
  $alpha: alpha(rgba($color-primary, 0.5));

  // Number functions
  width: percentage(0.5);
  width: round(4.6);
  width: ceil(4.2);
  width: floor(4.8);
  width: abs(-10);
  width: min(10px, 20px, 5px);
  width: max(10px, 20px, 5px);
  $random: random(100);
  $is-unitless: unitless(100);
  $unit: unit(100px);
  $comparable: comparable(100px, 10em);

  // String functions
  $quoted: quote(hello);
  $unquoted: unquote('hello');
  $length: str-length('hello');
  $inserted: str-insert('hello', ' world', 6);
  $index: str-index('hello', 'l');
  $slice: str-slice('hello', 2, 4);
  $upper: to-upper-case('hello');
  $lower: to-lower-case('HELLO');
  $unique: unique-id();

  // List functions
  $first: nth($spacing-sizes, 1);
  $last: nth($spacing-sizes, -1);
  $count: length($spacing-sizes);
  $joined: join((1, 2), (3, 4));
  $appended: append($spacing-sizes, 4rem);
  $zipped: zip((1, 2), (a, b));
  $index: index($spacing-sizes, 1rem);
  $separator: list-separator($spacing-sizes);
  $bracketed: is-bracketed([1, 2, 3]);
  $set-nth: set-nth($spacing-sizes, 1, 0.5rem);

  // Map functions
  $value: map-get($colors, 'primary');
  $merged: map-merge($colors, ('tertiary': #9b59b6));
  $removed: map-remove($colors, 'accent');
  $keys: map-keys($colors);
  $values: map-values($colors);
  $has-key: map-has-key($colors, 'primary');

  // Selector functions
  $nested: selector-nest('.parent', '.child');
  $appended: selector-append('.base', '--modifier');
  $extended: selector-extend('.a', '.b', '.c');
  $replaced: selector-replace('.a.b', '.a', '.c');
  $unified: selector-unify('.a.b', '.b.c');
  $simple: simple-selectors('.a.b');
  $is-super: is-superselector('.a', '.a.b');

  // Type functions
  $type: type-of($color-primary);
  $is-color: type-of($color-primary) == 'color';
  $is-number: type-of(42) == 'number';
  $is-string: type-of('hello') == 'string';
  $is-list: type-of($spacing-sizes) == 'list';
  $is-map: type-of($colors) == 'map';
  $is-bool: type-of(true) == 'bool';
  $is-null: type-of(null) == 'null';
  $is-function: type-of(get-function('lighten')) == 'function';

  // Meta functions
  $fn: get-function('lighten');
  $result: call($fn, $color-primary, 20%);
  $has-mixin: mixin-exists('clearfix');
  $has-function: function-exists('lighten');
  $has-variable: variable-exists('color-primary');
  $has-global: global-variable-exists('color-primary');

  // Feature checks
  $has-feature: feature-exists('global-variable-shadowing');
}

// =============================================================================
// Mixins
// =============================================================================

// Simple mixin
@mixin clearfix {
  &::after {
    content: '';
    display: table;
    clear: both;
  }
}

// Mixin with arguments
@mixin size($width, $height: $width) {
  width: $width;
  height: $height;
}

// Mixin with default arguments
@mixin button($bg: $color-primary, $color: white, $padding: $spacing-unit * 2) {
  background-color: $bg;
  color: $color;
  padding: $padding ($padding * 2);
  border: none;
  border-radius: $border-radius;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    background-color: darken($bg, 10%);
  }

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}

// Mixin with rest arguments
@mixin box-shadow($shadows...) {
  box-shadow: $shadows;
}

// Mixin with keyword arguments
@mixin typography($size: 1rem, $weight: 400, $line-height: 1.5, $color: inherit) {
  font-size: $size;
  font-weight: $weight;
  line-height: $line-height;
  color: $color;
}

// Mixin with content block
@mixin respond-to($breakpoint) {
  @if map-has-key($breakpoint-map, $breakpoint) {
    @media (min-width: map-get($breakpoint-map, $breakpoint)) {
      @content;
    }
  } @else {
    @warn "Unknown breakpoint: #{$breakpoint}";
  }
}

// Mixin with optional content
@mixin optional-content {
  @if & {
    @content;
  }
}

// Using mixins
.container {
  @include clearfix;
  max-width: 1200px;
  margin: 0 auto;
}

.btn {
  @include button;

  &--secondary {
    @include button($color-secondary);
  }

  &--outline {
    @include button(transparent, $color-primary);
    border: 2px solid $color-primary;
  }
}

.icon {
  @include size(24px);

  &--large {
    @include size(48px);
  }

  &--rect {
    @include size(32px, 24px);
  }
}

.text {
  @include typography($size: 1.25rem, $weight: 600);
}

.shadow-box {
  @include box-shadow(
    0 2px 4px rgba(0, 0, 0, 0.1),
    0 4px 8px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 white
  );
}

.responsive {
  @include respond-to('md') {
    display: flex;
    gap: $spacing-unit * 2;
  }

  @include respond-to('lg') {
    gap: $spacing-unit * 4;
  }
}

// =============================================================================
// Functions
// =============================================================================

// Simple function
@function double($value) {
  @return $value * 2;
}

// Function with type checking
@function rem($pixels, $base: 16) {
  @if type-of($pixels) != 'number' {
    @error "Expected number, got #{type-of($pixels)}";
  }
  @if unit($pixels) != 'px' and unit($pixels) != '' {
    @error "Expected pixels, got #{unit($pixels)}";
  }
  @return ($pixels / $base) * 1rem;
}

// Function with map access
@function color($name, $variant: null) {
  $color: map-get($colors, $name);

  @if $color == null {
    @warn "Color '#{$name}' not found in $colors map";
    @return null;
  }

  @if $variant == 'light' {
    @return lighten($color, 15%);
  } @else if $variant == 'dark' {
    @return darken($color, 15%);
  }

  @return $color;
}

// Function with theme support
@function theme-color($key, $theme-name: 'light') {
  $theme-colors: map-get($theme, $theme-name);
  @return map-get($theme-colors, $key);
}

// Recursive function
@function pow($base, $exponent) {
  @if $exponent == 0 {
    @return 1;
  } @else if $exponent > 0 {
    @return $base * pow($base, $exponent - 1);
  } @else {
    @return 1 / pow($base, -$exponent);
  }
}

// Strip unit function
@function strip-unit($value) {
  @return $value / ($value * 0 + 1);
}

// Clamp function
@function clamp-value($value, $min, $max) {
  @return min(max($value, $min), $max);
}

// Using functions
.function-examples {
  width: double(100px);
  font-size: rem(24px);
  padding: rem(16);
  background-color: color('primary');
  border-color: color('primary', 'dark');
  color: theme-color('text');
  z-index: pow(10, 3);
}

// =============================================================================
// Control Directives
// =============================================================================

// @if / @else if / @else
@mixin theme-styles($theme) {
  @if $theme == 'dark' {
    background: #1a1a1a;
    color: white;
  } @else if $theme == 'light' {
    background: white;
    color: #333;
  } @else {
    background: inherit;
    color: inherit;
  }
}

// Ternary-like with if()
$theme-mode: 'dark';
.conditional {
  background: if($theme-mode == 'dark', #1a1a1a, white);
  color: if($theme-mode == 'dark', white, #333);
}

// @for loop (through includes end value)
@for $i from 1 through 6 {
  h#{$i} {
    font-size: rem(32 - ($i * 4));
  }
}

// @for loop (to excludes end value)
@for $i from 0 to 5 {
  .mt-#{$i} {
    margin-top: $i * $spacing-unit;
  }
}

// @each loop with list
@each $size in $spacing-sizes {
  $i: index($spacing-sizes, $size);
  .p-#{$i - 1} {
    padding: $size;
  }
}

// @each loop with map
@each $name, $color in $colors {
  .text-#{$name} {
    color: $color;
  }

  .bg-#{$name} {
    background-color: $color;
  }

  .border-#{$name} {
    border-color: $color;
  }
}

// @each with destructuring
$icons: (
  'home': '\e900',
  'user': '\e901',
  'settings': '\e902',
);

@each $name, $code in $icons {
  .icon-#{$name}::before {
    content: $code;
  }
}

// @while loop
$columns: 12;
$i: 1;
@while $i <= $columns {
  .grid-#{$i} {
    width: percentage($i / $columns);
  }
  $i: $i + 1;
}

// =============================================================================
// Error Handling
// =============================================================================

@mixin require-color($color) {
  @if type-of($color) != 'color' {
    @error "Expected color, got #{type-of($color)}: #{$color}";
  }
  color: $color;
}

@mixin deprecated-mixin() {
  @warn "This mixin is deprecated and will be removed in v2.0";
}

@mixin debug-info($value) {
  @debug "Value: #{$value}, Type: #{type-of($value)}";
}

// =============================================================================
// Extending and Placeholders
// =============================================================================

// Placeholder selector
%visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

%button-base {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: $spacing-unit * 1.5 $spacing-unit * 3;
  border: none;
  border-radius: $border-radius;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

%card-base {
  background: white;
  border-radius: $border-radius * 2;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  padding: $spacing-unit * 3;
}

// Using extend
.sr-only {
  @extend %visually-hidden;
}

.skip-link:not(:focus) {
  @extend %visually-hidden;
}

.btn-primary {
  @extend %button-base;
  background: $color-primary;
  color: white;

  &:hover {
    background: darken($color-primary, 10%);
  }
}

.btn-secondary {
  @extend %button-base;
  background: $color-secondary;
  color: white;
}

.card {
  @extend %card-base;
}

.card-elevated {
  @extend %card-base;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

// Extending regular selectors
.error {
  color: red;
  font-weight: bold;
}

.critical-error {
  @extend .error;
  background: lighten(red, 40%);
  padding: $spacing-unit * 2;
}

// Optional extend
.optional {
  @extend .may-not-exist !optional;
}

// =============================================================================
// Imports and Modules
// =============================================================================

// Old-style imports (deprecated)
// @import 'variables';
// @import 'mixins';
// @import 'components/button';

// New module system
@use 'sass:math';
@use 'sass:color';
@use 'sass:list';
@use 'sass:map';
@use 'sass:string';
@use 'sass:meta';
@use 'sass:selector';

// @use with namespace
// @use 'components/button' as btn;
// @use 'utils/mixins' as *;
// @use 'config' with ($primary-color: blue);

// @forward
// @forward 'variables';
// @forward 'mixins' hide internal-mixin;
// @forward 'functions' show public-function;
// @forward 'config' as config-*;

// Using built-in modules
.math-examples {
  width: math.div(100%, 3);
  height: math.ceil(4.2px);
  padding: math.clamp(10px, 2vw, 50px);
  $sqrt: math.sqrt(16);
  $pow: math.pow(2, 3);
  $abs: math.abs(-10);
  $log: math.log(10);
}

.color-examples {
  $adjusted: color.adjust($color-primary, $lightness: 10%);
  $scaled: color.scale($color-primary, $lightness: 20%);
  $mixed: color.mix($color-primary, $color-secondary, 50%);
  $hue: color.hue($color-primary);
  $lightness: color.lightness($color-primary);
  $saturation: color.saturation($color-primary);
  $hwb: color.hwb($color-primary);
}

// =============================================================================
// At-Rules in SCSS
// =============================================================================

// @media
@media screen and (min-width: 768px) {
  .desktop-only {
    display: block;
  }
}

@media print {
  .no-print {
    display: none !important;
  }
}

// @supports
@supports (display: grid) {
  .grid-layout {
    display: grid;
  }
}

@supports not (display: grid) {
  .grid-fallback {
    display: flex;
  }
}

// @keyframes
@keyframes fade-in {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.05);
  }
}

// @font-face
@font-face {
  font-family: 'CustomFont';
  src: url('#{$image-path}fonts/custom.woff2') format('woff2'),
       url('#{$image-path}fonts/custom.woff') format('woff');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

// =============================================================================
// Example Component
// =============================================================================

.component {
  // Base styles
  display: flex;
  flex-direction: column;
  gap: $spacing-unit * 2;
  padding: $spacing-unit * 3;
  background: white;
  border-radius: $border-radius * 2;
  box-shadow: if($enable-shadows, 0 2px 8px rgba(0, 0, 0, 0.1), none);

  // Conditional styles
  @if $enable-rounded {
    border-radius: $border-radius * 2;
  }

  @if $enable-transitions {
    transition: all 0.3s ease;
  }

  // Child elements
  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-bottom: $spacing-unit * 2;
    border-bottom: 1px solid #eee;

    .title {
      @include typography($size: 1.25rem, $weight: 600);
    }
  }

  &__body {
    flex: 1;
    padding: $spacing-unit * 2 0;
  }

  &__footer {
    display: flex;
    gap: $spacing-unit;
    padding-top: $spacing-unit * 2;
    border-top: 1px solid #eee;
  }

  // Modifiers
  &--primary {
    background: color('primary');
    color: white;
  }

  &--compact {
    padding: $spacing-unit * 2;
    gap: $spacing-unit;
  }

  // States
  &:hover {
    @if $enable-shadows {
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
    }
  }

  &:focus-within {
    outline: 2px solid color('primary');
    outline-offset: 2px;
  }

  // Responsive
  @include respond-to('md') {
    flex-direction: row;
  }

  @include respond-to('lg') {
    padding: $spacing-unit * 4;
  }
}
